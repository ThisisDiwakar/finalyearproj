# ğŸ—ï¸ Blue Carbon Registry - System Architecture

## High-Level Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         FRONTEND (React)                            â”‚
â”‚                     http://localhost:5173                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚  User Dashboard  â”‚         â”‚  Admin Dashboard     â”‚            â”‚
â”‚  â”‚                  â”‚         â”‚                      â”‚            â”‚
â”‚  â”‚  â€¢ Submit Projectâ”‚         â”‚  â€¢ View All Projects â”‚            â”‚
â”‚  â”‚  â€¢ View Status   â”‚         â”‚  â€¢ Approve/Reject    â”‚            â”‚
â”‚  â”‚  â€¢ Track Progressâ”‚         â”‚  â€¢ Analytics         â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚           â”‚                              â”‚                         â”‚
â”‚           â”‚                              â”‚                         â”‚
â”‚           â–¼                              â–¼                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚         API Service (axios)                     â”‚              â”‚
â”‚  â”‚  â€¢ /api/projects                                â”‚              â”‚
â”‚  â”‚  â€¢ /api/admin/*                                 â”‚              â”‚
â”‚  â”‚  â€¢ ipfsService.js (IPFS client)                 â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                       â”‚                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â”‚ HTTP/REST
                        â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       â–¼                                            â”‚
â”‚                 BACKEND (Express.js)                               â”‚
â”‚              http://localhost:5000/api                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                    API Routes                                 â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â”‚  /api/auth/*          /api/projects/*      /api/admin/*      â”‚ â”‚
â”‚  â”‚  â€¢ register           â€¢ POST /             â€¢ GET /ipfs-hash  â”‚ â”‚
â”‚  â”‚  â€¢ login              â€¢ GET /              â€¢ POST /sync-ipfs â”‚ â”‚
â”‚  â”‚                       â€¢ PUT /:id           â€¢ POST /:id/approveâ”‚ â”‚
â”‚  â”‚                                            â€¢ POST /:id/reject â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚              â”‚                  â”‚                 â”‚                â”‚
â”‚              â–¼                  â–¼                 â–¼                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Auth Middleware â”‚  â”‚   Models     â”‚  â”‚  IPFS Services   â”‚   â”‚
â”‚  â”‚                  â”‚  â”‚              â”‚  â”‚                  â”‚   â”‚
â”‚  â”‚  â€¢ JWT Verify    â”‚  â”‚  â€¢ User      â”‚  â”‚  â€¢ ipfsSync.js   â”‚   â”‚
â”‚  â”‚  â€¢ Role Check    â”‚  â”‚  â€¢ Project   â”‚  â”‚  â€¢ ipfs.js       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                               â”‚                    â”‚              â”‚
â”‚                               â–¼                    â–¼              â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚                    â”‚    MongoDB       â”‚  â”‚  Pinata IPFS     â”‚   â”‚
â”‚                    â”‚                  â”‚  â”‚                  â”‚   â”‚
â”‚                    â”‚  â€¢ users         â”‚  â”‚  â€¢ File Upload   â”‚   â”‚
â”‚                    â”‚  â€¢ projects      â”‚  â”‚  â€¢ JSON Upload   â”‚   â”‚
â”‚                    â”‚                  â”‚  â”‚  â€¢ Pin Managementâ”‚   â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Data Flow: User Submits Project

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    USER     â”‚
â”‚  Dashboard  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 1. Fill form & upload photos
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  POST /api/projects                     â”‚
â”‚  â€¢ Validate input                       â”‚
â”‚  â€¢ Upload photos to IPFS (Pinata)       â”‚
â”‚  â€¢ Save project to MongoDB              â”‚
â”‚  â€¢ Return success response              â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 2. Trigger auto-sync (non-blocking)
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  autoSyncToIPFS()                       â”‚
â”‚  â€¢ Fetch all projects from MongoDB      â”‚
â”‚  â€¢ Calculate statistics                 â”‚
â”‚  â€¢ Create activity feed                 â”‚
â”‚  â€¢ Generate JSON snapshot               â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 3. Upload to IPFS
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  uploadJSONToIPFS()                     â”‚
â”‚  â€¢ POST to Pinata API                   â”‚
â”‚  â€¢ Pin JSON data                        â”‚
â”‚  â€¢ Return IPFS hash (QmXxxx...)         â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 4. Save snapshot metadata
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  saveSnapshotHash()                     â”‚
â”‚  â€¢ Write to backend/data/               â”‚
â”‚    latest-snapshot.json                 â”‚
â”‚  â€¢ Store: hash, url, stats, timestamp   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Data Flow: Admin Views Dashboard

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    ADMIN    â”‚
â”‚  Dashboard  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 1. Component mounts
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  fetchIPFSData()                        â”‚
â”‚  â€¢ Call getLatestIPFSHash()             â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 2. Get IPFS hash
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  GET /api/admin/ipfs-hash               â”‚
â”‚  â€¢ Read backend/data/latest-snapshot.jsonâ”‚
â”‚  â€¢ Return: hash, url, stats, timestamp  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 3. Validate hash
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  validateHash(hash)                     â”‚
â”‚  â€¢ Check format (Qm... or b...)         â”‚
â”‚  â€¢ Verify not empty                     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 4. Fetch from IPFS
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  fetchFromIPFS(hash)                    â”‚
â”‚  â€¢ GET https://gateway.pinata.cloud/    â”‚
â”‚    ipfs/{hash}                          â”‚
â”‚  â€¢ Timeout: 30 seconds                  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 5. Parse data
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  parseAndValidateData(rawData)          â”‚
â”‚  â€¢ Extract stats                        â”‚
â”‚  â€¢ Extract projects array               â”‚
â”‚  â€¢ Extract activity feed                â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 6. Update dashboard
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  setDashboardData(data)                 â”‚
â”‚  â€¢ Update stats cards                   â”‚
â”‚  â€¢ Render map pins                      â”‚
â”‚  â€¢ Populate projects table              â”‚
â”‚  â€¢ Show activity feed                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚  FALLBACK: If IPFS fails        â”‚
       â”‚  â€¢ Fetch from MongoDB directly  â”‚
       â”‚  â€¢ Calculate stats on-the-fly   â”‚
       â”‚  â€¢ Return same data structure   â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Data Flow: Admin Approves Project

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    ADMIN    â”‚
â”‚  Dashboard  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 1. Click "Approve" button
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  POST /api/admin/projects/:id/approve   â”‚
â”‚  â€¢ Find project by ID                   â”‚
â”‚  â€¢ Update status to APPROVED            â”‚
â”‚  â€¢ Set approvedBy and approvedAt        â”‚
â”‚  â€¢ Save to MongoDB                      â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 2. Trigger auto-sync
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  autoSyncToIPFS()                       â”‚
â”‚  â€¢ Create new snapshot with updated     â”‚
â”‚    project status                       â”‚
â”‚  â€¢ Upload to IPFS                       â”‚
â”‚  â€¢ Save new hash                        â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 3. Return success
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Dashboard Updates                      â”‚
â”‚  â€¢ Project status changes to APPROVED   â”‚
â”‚  â€¢ Stats cards update                   â”‚
â”‚  â€¢ Activity feed shows new action       â”‚
â”‚  â€¢ Map pin color changes to green       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Component Architecture

### Frontend Components

```
src/
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ Admin/
â”‚   â”‚   â”œâ”€â”€ AdminDashboard.jsx          â† Main container
â”‚   â”‚   â”œâ”€â”€ AdminHeader.jsx             â† Navigation & user info
â”‚   â”‚   â”œâ”€â”€ QuickActions.jsx            â† Filters & action buttons
â”‚   â”‚   â”œâ”€â”€ ProjectsTable.jsx           â† Projects list
â”‚   â”‚   â”œâ”€â”€ ActivityFeed.jsx            â† Recent actions
â”‚   â”‚   â”œâ”€â”€ AnalyticsPanel.jsx          â† Charts & graphs
â”‚   â”‚   â”œâ”€â”€ StatsCards/
â”‚   â”‚   â”‚   â”œâ”€â”€ StatsCards.jsx          â† Container
â”‚   â”‚   â”‚   â”œâ”€â”€ ProjectsCard.jsx        â† Total projects
â”‚   â”‚   â”‚   â”œâ”€â”€ AreaCard.jsx            â† Total area
â”‚   â”‚   â”‚   â”œâ”€â”€ CarbonCard.jsx          â† COâ‚‚ impact
â”‚   â”‚   â”‚   â””â”€â”€ EarningsCard.jsx        â† Earnings
â”‚   â”‚   â”œâ”€â”€ MapSection/
â”‚   â”‚   â”‚   â”œâ”€â”€ MapSection.jsx          â† Map container
â”‚   â”‚   â”‚   â”œâ”€â”€ IndiaMap.jsx            â† Leaflet map
â”‚   â”‚   â”‚   â”œâ”€â”€ FiltersBar.jsx          â† Map filters
â”‚   â”‚   â”‚   â””â”€â”€ ProjectDrawer.jsx       â† Project details
â”‚   â”‚   â””â”€â”€ Pages/
â”‚   â”‚       â”œâ”€â”€ IndiaMapPage.jsx        â† Full map view
â”‚   â”‚       â”œâ”€â”€ AnalyticsPage.jsx       â† Analytics view
â”‚   â”‚       â”œâ”€â”€ UsersPage.jsx           â† Users management
â”‚   â”‚       â””â”€â”€ ReportsPage.jsx         â† Reports view
â”‚   â”œâ”€â”€ Auth/
â”‚   â”‚   â”œâ”€â”€ Login.jsx
â”‚   â”‚   â””â”€â”€ Register.jsx
â”‚   â”œâ”€â”€ Dashboard/
â”‚   â”‚   â””â”€â”€ Dashboard.jsx               â† User dashboard
â”‚   â””â”€â”€ Project/
â”‚       â”œâ”€â”€ ProjectSubmission.jsx       â† Submit form
â”‚       â””â”€â”€ ProjectList.jsx             â† User's projects
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ api.js                          â† Axios instance
â”‚   â””â”€â”€ ipfsService.js                  â† IPFS client
â””â”€â”€ context/
    â””â”€â”€ AuthContext.jsx                 â† Auth state
```

### Backend Structure

```
backend/
â”œâ”€â”€ routes/
â”‚   â”œâ”€â”€ auth.js                         â† /api/auth/*
â”‚   â”œâ”€â”€ project.js                      â† /api/projects/*
â”‚   â””â”€â”€ admin.js                        â† /api/admin/*
â”œâ”€â”€ models/
â”‚   â”œâ”€â”€ User.js                         â† User schema
â”‚   â””â”€â”€ Project.js                      â† Project schema
â”œâ”€â”€ middleware/
â”‚   â””â”€â”€ auth.js                         â† JWT & role check
â”œâ”€â”€ services/
â”‚   â””â”€â”€ ipfsSync.js                     â† IPFS sync logic
â”œâ”€â”€ utils/
â”‚   â””â”€â”€ ipfs.js                         â† Pinata integration
â”œâ”€â”€ config/
â”‚   â””â”€â”€ db.js                           â† MongoDB connection
â”œâ”€â”€ data/
â”‚   â””â”€â”€ latest-snapshot.json            â† IPFS metadata
â””â”€â”€ server.js                           â† Express app
```

---

## Database Schema

### User Collection

```javascript
{
  _id: ObjectId,
  name: String,
  email: String (unique),
  password: String (hashed),
  role: String (enum: ['community_member', 'ngo', 'verifier', 'admin']),
  organization: String,
  phone: String,
  createdAt: Date,
  updatedAt: Date
}
```

### Project Collection

```javascript
{
  _id: ObjectId,
  projectId: String (auto-generated),
  projectName: String,
  description: String,
  submittedBy: ObjectId (ref: User),
  
  location: {
    latitude: Number,
    longitude: Number,
    state: String,
    district: String,
    village: String,
    coastalZone: String
  },
  
  restoration: {
    areaHectares: Number,
    species: [{
      name: String,
      count: Number
    }],
    ecosystemType: String,
    plantingDate: Date
  },
  
  carbon: {
    sequestrationRate: Number,
    estimatedCO2e: Number (calculated)
  },
  
  photos: [{
    filename: String,
    originalName: String,
    ipfsHash: String,
    ipfsUrl: String,
    photoType: String
  }],
  
  status: String (enum: ['DRAFT', 'SUBMITTED', 'PENDING', 'REVIEW', 'APPROVED', 'REJECTED', 'MINTED']),
  
  statusHistory: [{
    status: String,
    changedBy: ObjectId,
    changedAt: Date,
    remarks: String
  }],
  
  approvedBy: ObjectId,
  approvedAt: Date,
  rejectedBy: ObjectId,
  rejectedAt: Date,
  rejectionReason: String,
  
  createdAt: Date,
  updatedAt: Date
}
```

---

## IPFS Snapshot Structure

### latest-snapshot.json

```javascript
{
  "ipfsHash": "QmXxxx...",
  "ipfsUrl": "https://gateway.pinata.cloud/ipfs/QmXxxx...",
  "stats": {
    "totalProjects": 10,
    "pendingProjects": 3,
    "reviewProjects": 2,
    "approvedProjects": 4,
    "rejectedProjects": 1,
    "totalArea": 125.5,
    "totalCarbon": 1882.5
  },
  "timestamp": "2024-02-24T10:30:00.000Z"
}
```

### Registry Snapshot (on IPFS)

```javascript
{
  "version": "1.0",
  "timestamp": "2024-02-24T10:30:00.000Z",
  
  "stats": {
    "totalProjects": 10,
    "pendingProjects": 3,
    "reviewProjects": 2,
    "approvedProjects": 4,
    "rejectedProjects": 1,
    "totalArea": 125.5,
    "totalCarbon": 1882.5,
    "lastUpdated": "2024-02-24T10:30:00.000Z"
  },
  
  "projects": [
    {
      "_id": "...",
      "projectId": "BCR-2024-001",
      "projectName": "Mangrove Restoration",
      "status": "APPROVED",
      "location": { ... },
      "restoration": { ... },
      "carbon": { ... },
      "submittedBy": { ... },
      "createdAt": "...",
      "updatedAt": "..."
    }
    // ... more projects
  ],
  
  "activityFeed": [
    {
      "id": "...",
      "projectId": "BCR-2024-001",
      "action": "Community submitted project BCR-2024-001",
      "timestamp": "2024-02-24T10:00:00.000Z",
      "status": "approved",
      "location": "Tamil Nadu"
    }
    // ... more activities
  ]
}
```

---

## API Endpoints Reference

### Authentication

```
POST /api/auth/register    - Register new user
POST /api/auth/login       - Login user
GET  /api/auth/me          - Get current user
```

### Projects (User)

```
POST /api/projects         - Submit new project
GET  /api/projects         - Get user's projects
GET  /api/projects/:id     - Get single project
PUT  /api/projects/:id     - Update project
```

### Admin

```
GET  /api/admin/ipfs-hash                    - Get latest IPFS hash
POST /api/admin/sync-ipfs                    - Trigger IPFS sync
POST /api/admin/projects/:id/approve         - Approve project
POST /api/admin/projects/:id/reject          - Reject project
POST /api/admin/projects/:id/send-to-verifier - Send to verifier
GET  /api/admin/stats                        - Get statistics
GET  /api/admin/users                        - Get all users
```

---

## Security Architecture

### Authentication Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Client    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 1. POST /api/auth/login
       â”‚    { email, password }
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Backend                                â”‚
â”‚  â€¢ Validate credentials                 â”‚
â”‚  â€¢ Generate JWT token                   â”‚
â”‚  â€¢ Return: { token, user }              â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 2. Store token in localStorage
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Client                                 â”‚
â”‚  â€¢ Save token: bcr_token                â”‚
â”‚  â€¢ Include in all requests:             â”‚
â”‚    Authorization: Bearer <token>        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Authorization Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Request   â”‚
â”‚  with Token â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  auth Middleware                        â”‚
â”‚  â€¢ Verify JWT token                     â”‚
â”‚  â€¢ Decode user info                     â”‚
â”‚  â€¢ Attach to req.user                   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  authorize('admin') Middleware          â”‚
â”‚  â€¢ Check req.user.role === 'admin'      â”‚
â”‚  â€¢ Allow or deny access                 â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Route Handler                          â”‚
â”‚  â€¢ Process request                      â”‚
â”‚  â€¢ Return response                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Deployment Architecture

### Development

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Local Machine                           â”‚
â”‚                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Frontend      â”‚  â”‚  Backend       â”‚ â”‚
â”‚  â”‚  :5173         â”‚  â”‚  :5000         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  MongoDB       â”‚  â”‚  Pinata IPFS   â”‚ â”‚
â”‚  â”‚  :27017        â”‚  â”‚  (Cloud)       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Production

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Cloud Infrastructure                                    â”‚
â”‚                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Frontend (Vercel/Netlify)                         â”‚ â”‚
â”‚  â”‚  â€¢ Static hosting                                  â”‚ â”‚
â”‚  â”‚  â€¢ CDN distribution                                â”‚ â”‚
â”‚  â”‚  â€¢ HTTPS enabled                                   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Backend (Heroku/Railway/DigitalOcean)             â”‚ â”‚
â”‚  â”‚  â€¢ Node.js server                                  â”‚ â”‚
â”‚  â”‚  â€¢ Environment variables                           â”‚ â”‚
â”‚  â”‚  â€¢ Auto-scaling                                    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  MongoDB Atlas                                     â”‚ â”‚
â”‚  â”‚  â€¢ Managed database                                â”‚ â”‚
â”‚  â”‚  â€¢ Automatic backups                               â”‚ â”‚
â”‚  â”‚  â€¢ Replication                                     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Pinata IPFS                                       â”‚ â”‚
â”‚  â”‚  â€¢ Dedicated gateway                               â”‚ â”‚
â”‚  â”‚  â€¢ Pin management                                  â”‚ â”‚
â”‚  â”‚  â€¢ Analytics                                       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

**Last Updated**: February 24, 2026
**Version**: 1.0.0
